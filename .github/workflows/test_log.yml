name: ì‹¤í—˜ì‹¤ (test-log)

on:
  workflow_dispatch:
    inputs:
      test_msg:
        description: 'í…ŒìŠ¤íŠ¸í•  ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”'
        required: false
        default: 'Hello Lotto!'
    
permissions:
  contents: write
  
jobs:
  test_job :
    runs-on: ubuntu-latest
    steps : 
        # ê²°ê³¼ê°’: 1(ì›”) ~ 6(í† ) ~ 7(ì¼)
      - name: ìš”ì¼ í™•ì¸ (í•œêµ­ì‹œê°„ ê¸°ì¤€)
        run: |
            # TZ='Asia/Seoul'ì„ ë¶™ì—¬ì•¼ í•œêµ­ ì‹œê°„ì´ ë‚˜ì˜µë‹ˆë‹¤.
            # date +%u ëŠ” ìš”ì¼ì„ ìˆ«ìë¡œ ì¶œë ¥í•©ë‹ˆë‹¤ (1=ì›”, 6=í† , 7=ì¼)
            echo "DAY_OF_WEEK=$(TZ='Asia/Seoul' date +%u)" >> $GITHUB_ENV
      - name : ì¼ìš”ì¼
        if : github.event.schedule == '* * * * 0'
        run : echo "sun"
      - name : ì›”ìš”ì¼
        if : github.event.schedule == '* * * * 1'
        run : echo "mon"
      - name : í™”ìš”ì¼
        if : github.event.schedule == '* * * * 2'
        run : echo "tue"
      - name : ìˆ˜ìš”ì¼
        if : github.event.schedule == '* * * * 3'
        run : echo "wed"
      - name : ëª©ìš”ì¼
        if : github.event.schedule == '* * * * 4'
        run : echo "thu"
      - name : ê¸ˆìš”ì¼
        if : github.event.schedule == '* * * * 5'
        run : echo "fri"
      - name : í† ìš”ì¼
        if : github.event.schedule == '* * * * 6'
        run : echo "sat"
      - name : ì‹¤íŒ¨ì‹œ
        run : echo "${{ env.DAY_OF_WEEK }}"

    # steps:
    # # 1. í™˜ê²½ ì„¤ì •
    # - name: ì²´í¬ì•„ì›ƒ
    #   uses: actions/checkout@v3

    # # 2. íŒŒì´ì¬ìœ¼ë¡œ ë¡œê·¸ íŒŒì¼ ë§Œë“¤ê¸° (ì‹¤í—˜ìš©)
    # - name: íŒŒì´ì¬ ë¡œê·¸ ìƒì„± í…ŒìŠ¤íŠ¸
    #   run: |
    #     # íŒŒì´ì¬ ì½”ë“œë¥¼ ì¦‰ì„ì—ì„œ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.
    #     cat <<EOF > test_script.py
    #     import datetime
    #     import sys

    #     # ì…ë ¥ë°›ì€ ë©”ì‹œì§€
    #     msg = "${{ inputs.log_message }}"
    #     now = datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")

    #     log_content = f"[{now}] ë¡œê·¸ ì‹œì‘\n"
    #     log_content += f"[{now}] ì…ë ¥ ë©”ì‹œì§€: {msg}\n"
    #     log_content += f"[{now}] ê³„ì‚° í…ŒìŠ¤íŠ¸: 1+1={1+1}\n"
    #     log_content += f"[{now}] ë¡œê·¸ ì¢…ë£Œ"

    #     # 1) í™”ë©´(Console)ì— ì¶œë ¥ (ë°©ë²• A)
    #     print("--- ì½˜ì†” ì¶œë ¥ ì‹œì‘ ---")
    #     print(log_content)
    #     print("--- ì½˜ì†” ì¶œë ¥ ë ---")

    #     # 2) íŒŒì¼(log.txt)ì— ì €ì¥ (ë°©ë²• B)
    #     with open("execution.log", "w", encoding="utf-8") as f:
    #         f.write(log_content)
        
    #     # 3) ê¹ƒí—ˆë¸Œ ìš”ì•½(Summary)ì— ì¶œë ¥ (ë°©ë²• C - ë§ˆí¬ë‹¤ìš´ ì§€ì›)
    #     with open(os.environ['GITHUB_STEP_SUMMARY'], 'a', encoding='utf-8') as f:
    #          f.write("## ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë¦¬í¬íŠ¸\n")
    #          f.write(f"- **ì‹œê°„**: {now}\n")
    #          f.write(f"- **ë©”ì‹œì§€**: {msg}\n")
    #          f.write("> í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!")
    #     EOF
        
    #     # ìœ„ì—ì„œ ë§Œë“  íŒŒì´ì¬ íŒŒì¼ ì‹¤í–‰
    #     python test_script.py

    # # 3. ë¡œê·¸ íŒŒì¼ ì—…ë¡œë“œ (ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„!)
    # # íŒŒì¼ì„ ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— Pushí•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, 'ë‹¤ìš´ë¡œë“œ' í•  ìˆ˜ ìˆê²Œ ì˜¬ë ¤ì¤ë‹ˆë‹¤.
    # # ì—ëŸ¬ê°€ ë‚˜ë„ ë¡œê·¸ëŠ” ë‚¨ì•„ì•¼ í•˜ë¯€ë¡œ 'always()' ì¡°ê±´ì„ ë‹µë‹ˆë‹¤.
    # - name: ë¡œê·¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œìš©ìœ¼ë¡œ ì—…ë¡œë“œ
    #   if: always() 
    #   uses: actions/upload-artifact@v4
    #   with:
    #     name: my-test-logs # ë‹¤ìš´ë¡œë“œë  íŒŒì¼ ì´ë¦„
    #     path: execution.log # ìœ„ì—ì„œ ë§Œë“  íŒŒì¼ëª…
    #     retention-days: 1   # 1ì¼ ë’¤ ìë™ ì‚­ì œ (ìš©ëŸ‰ ì ˆì•½)
